{
  "permissions": {
    "allow": [
      "Bash(del \"C:\\Users\\juanjo\\Documents\\Arduino\\sketch_mar28a\\sketch_mar28a.ino\")",
      "WebFetch(domain:emalliab.wordpress.com)",
      "Bash(git add:*)",
      "WebFetch(domain:ascom-standards.org)",
      "WebSearch",
      "WebFetch(domain:github.com)",
      "Bash(git commit:*)",
      "Bash(git reset:*)",
      "Bash(git push:*)",
      "Bash(gh run list:*)",
      "Bash(gh.exe:*)",
      "Bash(source ~/.bashrc)",
      "Read(//c/Program Files//**)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run list)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18049330558)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18049330558 --log-failed)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run list --limit 3)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18049595989 --log-failed)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run watch)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run list --limit 1)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18049656332 --log-failed)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18049656332)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18058243712 --log-failed)",
      "Bash(mkdocs build:*)",
      "Bash(python:*)",
      "Bash(pio run:*)",
      "Read(//c/Users/juanjo/**)",
      "Bash(\"/c/Users/juanjo/.platformio/penv/Scripts/pio.exe\" run)",
      "Bash(\"/c/Users/juanjo/.platformio/penv/Scripts/pio.exe\" run --environment esp32-c3-devkitm-1)",
      "Bash(/c/Users/juanjo/.platformio/penv/Scripts/pio.exe run --environment esp32-c3-devkitm-1)",
      "Bash(git checkout:*)",
      "Bash(/c/Users/juanjo/.platformio/penv/Scripts/pio.exe run)",
      "Bash(/c/Users/juanjo/.platformio/penv/Scripts/pio.exe run -t upload)",
      "Bash(platformio run:*)",
      "Bash(~/.platformio/penv/Scripts/platformio.exe run)",
      "Bash(git tag:*)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" release create v2.0.0 --title \"v2.0.0 - PID-Based Encoder Control System\" --notes \"$(cat <<''EOF''\n# 🎉 Version 2.0.0 - Major Release\n\n## Overview\nComplete architectural redesign implementing closed-loop PID control for precision positioning using the AS5600 magnetic encoder.\n\n## ✨ Major Features\n\n### PID Controller System\n- **Precision Positioning**: Achieves <0.8° accuracy with closed-loop feedback\n- **Tuned Parameters**: Kp=4.5, Ki=0.01, Kd=0.3 optimized for 28BYJ-48 motor\n- **Automatic Correction**: Self-corrects for mechanical errors, backlash, and missed steps\n- **Bidirectional Movement**: Intelligently chooses shortest path to target\n\n### Enhanced Flexibility\n- **3-9 Filter Support**: Expanded from previous 3-8 filter limitation\n- **Configurable Encoder Direction**: New `AS5600_INVERT_DIRECTION` flag for easy hardware integration\n- **Dynamic Filter Names**: Runtime-configurable names with EEPROM persistence (up to 15 characters)\n- **Display Rotation**: Full 180° rotation support with coordinate adjustment\n\n### Simplified Calibration\n- **One-Step Calibration**: Simple `#CAL` command sets encoder offset\n- **No Manual Tuning**: Removed complex revolution/backlash calibration\n- **Persistent Storage**: Calibration stored in EEPROM across power cycles\n\n## 🔧 Technical Improvements\n\n### Code Cleanup\n- ✂️ Removed **1000+ lines** of obsolete calibration code\n- 🧹 Eliminated all deprecated comments and unused functions\n- 📝 Complete documentation overhaul with accurate specifications\n- 🎯 Simplified architecture focusing on encoder-based control\n\n### Performance\n- **Positioning Accuracy**: <0.8° (configurable via `ANGLE_CONTROL_TOLERANCE`)\n- **Control Loop**: Maximum 30 iterations with 150ms settling time\n- **Output Range**: 10-2000 steps per iteration for optimal response\n- **Anti-Windup**: Integral limit of 100.0 prevents accumulation\n\n## ⚠️ Breaking Changes\n\n### Removed Commands\nThe following commands are **no longer available** as they''re obsolete with encoder-based control:\n- `REVCAL`, `RCP`, `RCM`, `RCFIN` - Revolution calibration\n- `BLCAL`, `BLS`, `BLM`, `BLFIN`, `AUTOBLCAL` - Backlash calibration\n- `MDM`, `MRV`, `GDC` - Direction mode configuration\n- `SPR`, `GPR` - Steps per revolution\n\n### Configuration Changes\n- **DEVICE_ID**: Changed format to `ESP32FW-PID-V2.0`\n- **FIRMWARE_VERSION**: Now `2.0.0`\n- Motor direction now controlled via `AS5600_INVERT_DIRECTION` flag\n\n### Migration Notes\nIf upgrading from v1.x:\n1. Re-calibrate using `#CAL` command at filter position 1\n2. Update any custom scripts that used removed commands\n3. Set `AS5600_INVERT_DIRECTION` if motor/encoder directions don''t match\n\n## 📋 New Configuration Options\n\n### config.h Additions\n```cpp\n#define AS5600_INVERT_DIRECTION true   // Invert encoder direction\n#define ANGLE_PID_KP 4.5f              // PID proportional gain\n#define ANGLE_PID_KI 0.01f             // PID integral gain\n#define ANGLE_PID_KD 0.3f              // PID derivative gain\n#define ANGLE_CONTROL_TOLERANCE 0.8    // Target precision in degrees\n#define MAX_FILTER_COUNT 9             // Support up to 9 filters\n```\n\n## 📊 Statistics\n- **Lines Added**: 725\n- **Lines Removed**: 1460\n- **Net Reduction**: -735 lines (33% smaller codebase)\n- **Files Modified**: 15\n\n## 🔗 Documentation\n- [Complete Documentation](https://juanjol.github.io/autoFilterWheel/)\n- [CLAUDE.md](CLAUDE.md) - Developer guide with PID tuning\n- [README.md](README.md) - Updated specifications and commands\n\n## 🙏 Acknowledgments\nThis release represents a fundamental improvement in positioning accuracy and code maintainability. Special thanks to the open-source community for feedback and testing.\n\n---\n\n**Full Changelog**: https://github.com/juanjol/autoFilterWheel/compare/v1.0.0...v2.0.0\nEOF\n)\")",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" run view 18361049599 --log-failed)"
    ],
    "deny": [],
    "ask": []
  }
}
