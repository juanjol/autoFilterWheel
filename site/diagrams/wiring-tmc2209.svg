<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <title>ESP32-C3 Filter Wheel - TMC2209 Wiring Diagram</title>

  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa"/>

  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">
    TMC2209 + NEMA17 Wiring Diagram
  </text>

  <!-- ESP32-C3 Board -->
  <g id="esp32c3">
    <rect x="50" y="100" width="200" height="300" fill="#2e7d32" stroke="#1b5e20" stroke-width="2" rx="5"/>
    <text x="150" y="130" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">ESP32-C3</text>
    <text x="150" y="150" font-family="Arial" font-size="12" fill="white" text-anchor="middle">with 0.42" OLED</text>

    <!-- GPIO Pins Left Side -->
    <rect x="40" y="180" width="30" height="20" fill="#ffc107"/>
    <text x="55" y="195" font-size="10" text-anchor="middle">5V</text>

    <rect x="40" y="210" width="30" height="20" fill="#424242"/>
    <text x="55" y="225" font-size="10" fill="white" text-anchor="middle">GND</text>

    <rect x="40" y="240" width="30" height="20" fill="#2196f3"/>
    <text x="55" y="255" font-size="10" text-anchor="middle">IO2</text>

    <rect x="40" y="270" width="30" height="20" fill="#2196f3"/>
    <text x="55" y="285" font-size="10" text-anchor="middle">IO3</text>

    <rect x="40" y="300" width="30" height="20" fill="#2196f3"/>
    <text x="55" y="315" font-size="10" text-anchor="middle">IO4</text>

    <rect x="40" y="330" width="30" height="20" fill="#e91e63"/>
    <text x="55" y="345" font-size="10" text-anchor="middle">IO16</text>

    <rect x="40" y="360" width="30" height="20" fill="#e91e63"/>
    <text x="55" y="375" font-size="10" text-anchor="middle">IO17</text>

    <!-- GPIO Pins Right Side for I2C -->
    <rect x="230" y="240" width="30" height="20" fill="#9c27b0"/>
    <text x="245" y="255" font-size="10" text-anchor="middle">IO5</text>

    <rect x="230" y="270" width="30" height="20" fill="#9c27b0"/>
    <text x="245" y="285" font-size="10" text-anchor="middle">IO6</text>
  </g>

  <!-- TMC2209 Driver Board -->
  <g id="tmc2209">
    <rect x="350" y="150" width="180" height="280" fill="#d32f2f" stroke="#b71c1c" stroke-width="2" rx="5"/>
    <text x="440" y="180" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">TMC2209</text>
    <text x="440" y="200" font-family="Arial" font-size="12" fill="white" text-anchor="middle">SilentStepStick</text>

    <!-- Control Pins Left -->
    <rect x="340" y="220" width="25" height="15" fill="#2196f3"/>
    <text x="352" y="231" font-size="8" text-anchor="middle">STEP</text>

    <rect x="340" y="240" width="25" height="15" fill="#2196f3"/>
    <text x="352" y="251" font-size="8" text-anchor="middle">DIR</text>

    <rect x="340" y="260" width="25" height="15" fill="#2196f3"/>
    <text x="352" y="271" font-size="8" text-anchor="middle">EN</text>

    <!-- UART Pins -->
    <rect x="340" y="290" width="25" height="15" fill="#e91e63"/>
    <text x="352" y="301" font-size="8" text-anchor="middle">PDN</text>

    <rect x="340" y="310" width="25" height="15" fill="#e91e63"/>
    <text x="352" y="321" font-size="8" text-anchor="middle">UART</text>

    <!-- Power Pins Left -->
    <rect x="340" y="350" width="25" height="15" fill="#4caf50"/>
    <text x="352" y="361" font-size="8" text-anchor="middle">3.3V</text>

    <rect x="340" y="370" width="25" height="15" fill="#ffc107"/>
    <text x="352" y="381" font-size="8" text-anchor="middle">VIO</text>

    <rect x="340" y="390" width="25" height="15" fill="#424242"/>
    <text x="352" y="401" font-size="8" fill="white" text-anchor="middle">GND</text>

    <!-- Motor Power Right -->
    <rect x="515" y="220" width="30" height="15" fill="#ff5722"/>
    <text x="530" y="231" font-size="8" text-anchor="middle">M+</text>

    <rect x="515" y="240" width="30" height="15" fill="#424242"/>
    <text x="530" y="251" font-size="8" fill="white" text-anchor="middle">GND</text>

    <!-- Motor Pins Right -->
    <rect x="515" y="280" width="30" height="15" fill="#795548"/>
    <text x="530" y="291" font-size="8" text-anchor="middle">2B</text>

    <rect x="515" y="300" width="30" height="15" fill="#795548"/>
    <text x="530" y="311" font-size="8" text-anchor="middle">2A</text>

    <rect x="515" y="320" width="30" height="15" fill="#795548"/>
    <text x="530" y="331" font-size="8" text-anchor="middle">1A</text>

    <rect x="515" y="340" width="30" height="15" fill="#795548"/>
    <text x="530" y="351" font-size="8" text-anchor="middle">1B</text>
  </g>

  <!-- NEMA17 Stepper Motor -->
  <g id="nema17">
    <rect x="600" y="250" width="120" height="120" fill="#37474f" stroke="#263238" stroke-width="2" rx="3"/>
    <circle cx="660" cy="310" r="40" fill="#455a64"/>
    <circle cx="660" cy="310" r="8" fill="#263238"/>
    <text x="660" y="305" font-family="Arial" font-size="12" font-weight="bold" fill="white" text-anchor="middle">NEMA17</text>
    <text x="660" y="320" font-family="Arial" font-size="10" fill="white" text-anchor="middle">1.8°/step</text>

    <!-- Motor connector -->
    <rect x="580" y="300" width="40" height="20" fill="#795548"/>
    <text x="600" y="313" font-size="9" fill="white" text-anchor="middle">4-wire</text>
  </g>

  <!-- AS5600 Encoder (Optional) -->
  <g id="as5600">
    <rect x="550" y="420" width="120" height="80" fill="#673ab7" stroke="#512da8" stroke-width="2" rx="5"/>
    <text x="610" y="445" font-family="Arial" font-size="14" font-weight="bold" fill="white" text-anchor="middle">AS5600</text>
    <text x="610" y="462" font-family="Arial" font-size="11" fill="white" text-anchor="middle">Encoder</text>
    <text x="610" y="478" font-family="Arial" font-size="10" fill="white" text-anchor="middle">(Optional)</text>

    <!-- I2C Pins -->
    <rect x="540" y="430" width="25" height="15" fill="#9c27b0"/>
    <text x="552" y="441" font-size="8" text-anchor="middle">SDA</text>

    <rect x="540" y="450" width="25" height="15" fill="#9c27b0"/>
    <text x="552" y="461" font-size="8" text-anchor="middle">SCL</text>

    <rect x="540" y="470" width="25" height="15" fill="#4caf50"/>
    <text x="552" y="481" font-size="8" text-anchor="middle">3.3V</text>

    <rect x="540" y="490" width="25" height="15" fill="#424242"/>
    <text x="552" y="501" font-size="8" fill="white" text-anchor="middle">GND</text>
  </g>

  <!-- Power Supply -->
  <g id="power">
    <rect x="100" y="470" width="120" height="80" fill="#ff9800" stroke="#f57c00" stroke-width="2" rx="5"/>
    <text x="160" y="490" font-family="Arial" font-size="12" font-weight="bold" text-anchor="middle">12-24V Power</text>
    <text x="160" y="508" font-family="Arial" font-size="11" text-anchor="middle">Supply</text>
    <text x="160" y="525" font-family="Arial" font-size="10" text-anchor="middle">Min 2A</text>
    <text x="160" y="540" font-family="Arial" font-size="10" text-anchor="middle">(for motor)</text>
  </g>

  <!-- Wiring Lines -->
  <!-- ESP32 to TMC2209 Control -->
  <line x1="70" y1="250" x2="340" y2="227" stroke="#2196f3" stroke-width="2"/>
  <line x1="70" y1="280" x2="340" y2="247" stroke="#2196f3" stroke-width="2"/>
  <line x1="70" y1="310" x2="340" y2="267" stroke="#2196f3" stroke-width="2"/>

  <!-- UART connections -->
  <line x1="70" y1="340" x2="290" y2="340" stroke="#e91e63" stroke-width="2"/>
  <line x1="290" y1="340" x2="290" y2="297" stroke="#e91e63" stroke-width="2"/>
  <line x1="290" y1="297" x2="340" y2="297" stroke="#e91e63" stroke-width="2"/>

  <line x1="70" y1="370" x2="310" y2="370" stroke="#e91e63" stroke-width="2"/>
  <line x1="310" y1="370" x2="310" y2="317" stroke="#e91e63" stroke-width="2"/>
  <line x1="310" y1="317" x2="340" y2="317" stroke="#e91e63" stroke-width="2"/>

  <!-- Power connections -->
  <line x1="70" y1="190" x2="280" y2="190" stroke="#ffc107" stroke-width="3"/>
  <line x1="280" y1="190" x2="280" y2="377" stroke="#ffc107" stroke-width="3"/>
  <line x1="280" y1="377" x2="340" y2="377" stroke="#ffc107" stroke-width="3"/>

  <line x1="70" y1="220" x2="270" y2="220" stroke="#424242" stroke-width="3"/>
  <line x1="270" y1="220" x2="270" y2="397" stroke="#424242" stroke-width="3"/>
  <line x1="270" y1="397" x2="340" y2="397" stroke="#424242" stroke-width="3"/>

  <!-- Motor power from external supply -->
  <line x1="220" y1="490" x2="550" y2="490" stroke="#ff5722" stroke-width="4"/>
  <line x1="550" y1="490" x2="550" y2="227" stroke="#ff5722" stroke-width="4"/>
  <line x1="550" y1="227" x2="515" y2="227" stroke="#ff5722" stroke-width="4"/>

  <!-- TMC2209 to Motor -->
  <line x1="545" y1="310" x2="580" y2="310" stroke="#795548" stroke-width="3"/>

  <!-- I2C connections to AS5600 -->
  <line x1="260" y1="250" x2="400" y2="250" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="400" y1="250" x2="400" y2="437" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="400" y1="437" x2="540" y2="437" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>

  <line x1="260" y1="280" x2="420" y2="280" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="420" y1="280" x2="420" y2="457" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="420" y1="457" x2="540" y2="457" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>

  <!-- Labels -->
  <text x="150" y="235" font-size="9" fill="#2196f3">GPIO2 → STEP</text>
  <text x="150" y="255" font-size="9" fill="#2196f3">GPIO3 → DIR</text>
  <text x="150" y="275" font-size="9" fill="#2196f3">GPIO4 → EN</text>
  <text x="140" y="325" font-size="9" fill="#e91e63">GPIO16 → PDN/UART</text>
  <text x="140" y="345" font-size="9" fill="#e91e63">GPIO17 → UART</text>

  <text x="430" y="440" font-size="10" fill="#9c27b0">I2C Bus (Optional)</text>

  <!-- TMC2209 Features -->
  <text x="440" y="420" font-size="10" fill="white" text-anchor="middle">Features:</text>
  <text x="370" y="435" font-size="9" fill="white">• Silent operation</text>
  <text x="370" y="448" font-size="9" fill="white">• Microstepping (up to 256)</text>
  <text x="370" y="461" font-size="9" fill="white">• Stall detection</text>
  <text x="370" y="474" font-size="9" fill="white">• Current control</text>

  <!-- Legend -->
  <g id="legend">
    <rect x="50" y="560" width="700" height="30" fill="white" stroke="#ccc" rx="3"/>
    <text x="60" y="578" font-size="11">Colors:</text>
    <line x1="110" y1="575" x2="130" y2="575" stroke="#2196f3" stroke-width="2"/>
    <text x="135" y="578" font-size="11">Control</text>
    <line x1="190" y1="575" x2="210" y2="575" stroke="#e91e63" stroke-width="2"/>
    <text x="215" y="578" font-size="11">UART</text>
    <line x1="260" y1="575" x2="280" y2="575" stroke="#ff5722" stroke-width="3"/>
    <text x="285" y="578" font-size="11">Motor Power</text>
    <line x1="370" y1="575" x2="390" y2="575" stroke="#795548" stroke-width="3"/>
    <text x="395" y="578" font-size="11">Motor Phases</text>
    <line x1="480" y1="575" x2="500" y2="575" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5"/>
    <text x="505" y="578" font-size="11">I2C</text>
  </g>
</svg>